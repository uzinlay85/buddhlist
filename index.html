<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ဘုရားဝတ်တက် စစ်ဆေးရန်</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Pyidaungsu&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Pyidaungsu', sans-serif; }

    /* Seating Chart Grid */
    .grid-container { display: grid; gap: 0.5rem; grid-template-columns: repeat(16, minmax(0, 1fr)); }
    @media (max-width: 1024px) { .grid-container { grid-template-columns: repeat(8, minmax(0, 1fr)); } }
    @media (max-width: 640px) { 
      .grid-container { grid-template-columns: repeat(4, minmax(0, 1fr)); }
      .seat .font-bold { font-size: 0.875rem; }
      .seat .leading-tight { font-size: 11px; }
    }

    #seat-tooltip { pointer-events: none; white-space: pre-wrap; transition: opacity 0.2s; }
    .seat.absent { border: 3px solid #ef4444 !important; transform: scale(1.05); box-shadow: 0 0 8px rgba(239, 68, 68, 0.5); }
    .seat.on-leave { border: 3px solid #eab308 !important; transform: scale(1.05); box-shadow: 0 0 8px rgba(234, 179, 8, 0.5); }
    .seat.empty { background-color: #f3f4f6; border: 1px dashed #d1d5db; }
    .seat.left { background-color: #e5e7eb !important; color: #6b7280 !important; border-color: #d1d5db !important; cursor: not-allowed !important; }

    #admin-modal { display: none; }
    #admin-modal.show { display: flex; }

    .table-input { border: 1px solid #d1d5db; border-radius: 4px; padding: 4px 8px; width: 100%; }

    /* Printing */
    @media print {
      body > * { display: none !important; }
      #print-container, #print-container * { display: block !important; }
      #print-container { top: 0; left: 0; width: 100%; }

      .print-grid { display: grid !important; grid-template-columns: 1fr 1fr; gap: 15px; }
      .print-column { display: flex !important; flex-direction: column; gap: 8px; }

      .print-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; break-inside: avoid; }
      .print-table td {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        border: 1px solid #ccc !important;
        height: 55px;
        width: 6.25%;
        text-align: center;
        vertical-align: middle;
      }
      .print-seat-num { font-size: 8px; font-weight: bold; }
      .print-seat-name { font-size: 7px; line-height: 1.1; }
      .print-seat-left { font-size: 6px; font-weight: bold; color: #ef4444; }
    }
  </style>
</head>
<body class="bg-gray-100 p-2 sm:p-6 md:p-8">

  <!-- Print Container -->
  <div id="print-container"></div>

  <!-- Main -->
  <div id="main-content">
    <!-- Admin Button -->
    <div id="admin-panel-button" class="fixed top-4 right-4 z-50">
      <button class="bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg hover:bg-gray-700 transition">Admin Panel</button>
    </div>

    <div class="max-w-screen-2xl mx-auto bg-white rounded-2xl shadow-lg p-4 sm:p-6">
      <header class="text-center mb-6">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800">ဘုရားဝတ်တက် စစ်ဆေးရေးဇယား</h1>
        <p class="text-gray-600 mt-1 px-2">ခုံများကို နှိပ်၍ တက်ရောက်မှု အခြေအနေ ပြောင်းလဲနိုင်ပါသည်။</p>
        <p class="text-xs text-gray-500 mt-2">( ပထမကလစ် = ခွင့်ရှိသူ | ဒုတိယကလစ် = ပျက်ကွက် | တတိယကလစ် = တက်ရောက် )</p>
        <div class="mt-4">
          <button id="print-button" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-6 rounded-lg shadow-md">
            🖨️ ဇယားကွက်ကို Print/PDF ထုတ်ရန်
          </button>
        </div>
      </header>

      <div class="flex flex-col lg:flex-row gap-8">
        <!-- Seating -->
        <div class="flex-grow">
          <div class="bg-blue-600 text-white text-center py-2 rounded-t-lg font-bold shadow-md">စာချဆရာတော်များနှင့် ကျမ်းပြီးသံဃာ်များ</div>
          <div id="seating-chart-container" class="p-2 sm:p-4 bg-gray-50 border rounded-b-lg overflow-x-auto"></div>
          <div class="mt-4 flex justify-center">
            <button id="reset-button" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105">
              အားလုံးကို ပြန်သတ်မှတ်ရန်
            </button>
          </div>
        </div>

        <!-- Lists -->
        <div class="lg:w-1/3 xl:w-1/4 flex-shrink-0 space-y-4">
          <div class="bg-white p-4 rounded-lg shadow-md border">
            <div class="flex justify-between items-start mb-4 border-b pb-2">
              <div>
                <h2 class="text-xl font-bold text-red-700">ပျက်ကွက်စာရင်း</h2>
                <p id="current-date-absent" class="text-sm text-gray-500"></p>
              </div>
              <button id="copy-absent-button" class="bg-red-500 hover:bg-red-600 text-white text-xs font-bold py-1 px-3 rounded-lg shadow-md">ကူးယူရန်</button>
            </div>
            <ul id="absent-list" class="space-y-2 text-gray-700"></ul>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-md border">
            <div class="flex justify-between items-start mb-4 border-b pb-2">
              <div>
                <h2 class="text-xl font-bold text-yellow-700">ခွင့်ရှိသူစာရင်း</h2>
                <p id="current-date-leave" class="text-sm text-gray-500"></p>
              </div>
              <button id="copy-leave-button" class="bg-yellow-500 hover:bg-yellow-600 text-white text-xs font-bold py-1 px-3 rounded-lg shadow-md">ကူးယူရန်</button>
            </div>
            <ul id="leave-list" class="space-y-2 text-gray-700"></ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tooltip -->
  <div id="seat-tooltip" class="hidden absolute p-2 bg-gray-900 text-white text-sm rounded-md shadow-lg z-50"></div>

  <!-- Admin Modal -->
  <div id="admin-modal" class="fixed inset-0 bg-gray-600 bg-opacity-75 items-center justify-center z-40">
    <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-4xl overflow-auto" style="max-height: 80vh;">
      <h2 class="text-2xl font-bold mb-4">ကျောင်းသားစာရင်း ပြင်ဆင်ရန်</h2>
      <div class="overflow-auto border rounded-lg" style="max-height: 60vh;">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50 sticky top-0">
            <tr>
              <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">အတန်း</th>
              <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">ခုံ</th>
              <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">အမည်</th>
              <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">အဆောင်</th>
              <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">ကျောင်းထွက်</th>
              <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">ဖျက်ရန်</th>
            </tr>
          </thead>
          <tbody id="admin-table-body" class="divide-y divide-gray-200"></tbody>
        </table>
      </div>
      <div class="mt-6 flex justify-between items-center">
        <button id="add-row-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">အသစ်ထည့်ရန်</button>
        <div>
          <button id="download-csv-button" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">CSV ဒေါင်းလုဒ်</button>
          <button id="close-admin-modal" class="ml-4 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">ပိတ်ရန်</button>
        </div>
      </div>
    </div>
  </div>

  <!-- JS -->
  <script>
    // ဒီနေရာမှာ JavaScript ကို ပြန်ရေးဖို့လိုပါတယ် (DOM bug, syntax error, event binding error တွေကို ပြင်ပြီး)
    // အခု version မှာ အပြည့်စုံထည့်လိုပါသလား၊ ဒါမှမဟုတ် တခါတည်း ကိုယ်ပြင်ထားတဲ့ script ကိုပဲ သန့်ရှင်းအောင်ပေးချင်သလား?
  </script>
</body>
</html>
